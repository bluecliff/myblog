Date: 2013-5-31 14:23
tags: openWRT,ddWRT
title WNR2000v3安装DDWRT
md_linebreaks: two

支持的版本
===========

目前阶段，DDWRT对WNR2000V3的支持比较比较全面，有最新的预编译版本使用，但往往最新版本刷入后不能正常工作。目前测试通过可以正常工作的最新版本是r18777,下载地址http://www.dd-wrt.com/dd-wrtv2/down.php?path=downloads%2Fothers%2Feko%2FBrainSlayer-V24-preSP2%2F2012%2F03-19-12-r18777%2Fnetgear-wnr2000v3/。

安装
=========

DDWRT的安装方式比较多样，可以直接通过web安装，也可以通过TFTP模式安装，当然telnet方式也是支持的。但在安装之前都要注意几个事项：

- 所有新版本的安装都必须在原厂固件的基础上进行，或者在DDWRT已安装的版本上进行升级操作。
- 从原厂固件安装时，原厂固件版本不能高于v1.1.1.58。高于这个版本的原厂固件无法刷入DDWRT。
- 注意DDWRT的版本不能高于上一节中所述的版本，否则会变砖。
- 安装之前之后都要硬启动一次，硬启动的方式是打开电源，按住reset键30秒，不放开reset键，关闭电源，继续30秒，不放开reset键，打开电源继续30秒。
- 安装之后，不能立即执行硬启动，需要等待5分钟左右，待电源灯编程蓝色后才能执行硬启动，否则变砖。

WEB安装
--------

web安装方式是最简单的安装方式，第一小节中连接下载的有三个文件，其中一个是*-factory.img。这个文件即是支持从原厂固件直接升级的Img(这以文件有两个版本，NA表示北美地区的，WW表示国际版，建议使用WW版)。下载得到该文件后，直接从路由器的web管理界面的升级固件操作，上传固件到路由器即可完场安装，注意安装过程中时间较长，务必等待安装完成后再等待5分钟左右再执行硬启动。


TFTP方式安装
-------------

WNR2000V3的BootLoader内置有TFTP服务器，只要进入该模式之后，即可通过主机的TFTP命令把img镜像写入AP的RAM，再又bootLoader完成把img写入ROM并完成初始化操作。具体的操作过程如下：

1. 设定主机的IP地址为192.168.1.12(和192.168.1.1在同一网段即可)，掩码255.255.2555.0。
2. 主机网口接AP的任意一个LAN口。
3. 打开路由器，按住路由器的reset键，直到电源灯变为绿色开始闪烁。此时路由器处于TFTP upgrade状态。
4. 在主机中执行tftp命令 ::
 
 tftp -i 192.168.1.1 put *.img

该命令实现把img文件传入路由器。
5. 等待一段时间，路由器电源灯变为蓝色常亮，即刷入成功，硬启动即可。

TTL终端方式安装
----------------

WNR2000v3具有串口接口，接入TTL线可以进入AP的终端。此时也可以安装img镜像。具体操作如下：

1. 接好TTL线，USB口插入主机USB口，配置putty等终端登录工具的串口登录参数为：波特率115200，停止位1。流控制无。串口端口可以在硬件管理器总查询。
2. 接好TTL线后，启动路由器，终端可以看到输出。
3. 注意在bootloader启动不久会有提示：enter any key to stop booting。此时按任何键即进入了uboot的终端。
4. 在uboot的终端中可以采用tftp等命令传入img并写入ROM。


DDWRT刷机总结
==============

DDWRT的刷机方式比较多，并且经过实践，版本正确时都是可行的，刷入的DDWRT经过长时间测试，工作还是比较稳定的。
